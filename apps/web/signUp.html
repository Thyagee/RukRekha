<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RukRekha - Signup</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!--<script src="https://cdn.jsdelivr.net/npm/@meshsdk/core/browser.min.js"></script> -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

  <style>
    body {
      background-color: #F1F8E9;
      font-family: 'Roboto', sans-serif;
    }

    .side-img {
      background: url('https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&w=900&q=80') center center no-repeat;
      background-size: cover;
      border-radius: 12px 0 0 12px;
      min-height: 500px;
    }

    @media (max-width: 768px) {
      .side-img {
        display: none;
      }
    }

    .card {
      border-radius: 12px;
    }

    .card-header {
      background-color: #1B5E20;
      color: white;
      text-align: center;
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
    }

    .btn-success {
      background-color: #2E7D32;
    }
  </style>
</head>

<body>

  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-12 col-md-9">
        <div class="card shadow-lg d-flex flex-column flex-md-row">
          <div class="side-img col-md-6 d-none d-md-block"></div>
          <div class="col-md-6 p-4">
            <div class="card-header mb-3">
              <h3>RukRekha Signup</h3>
            </div>
            <form>
              <div class="mb-3">
                <label>Organization Name</label>
                <input type="text" id="orgName" class="form-control" placeholder="Your organization name" required>
              </div>
              <div class="mb-3">
                <label>Contact First Name</label>
                <input type="text" id="firstName" class="form-control" placeholder="First Name" required>
              </div>
              <div class="mb-3">
                <label>Last Name</label>
                <input type="text" id="lastName" class="form-control" placeholder="Last Name" required>
              </div>
              <div class="mb-3">
                <label>Email</label>
                <input type="email" id="email" class="form-control" placeholder="Enter email" required>
              </div>
              <div class="mb-3">
                <label>Phone Number (WhatsApp preferred)</label>
                <input type="tel" id="phone" class="form-control" placeholder="+94XXXXXXXXX" required>
              </div>
              <div class="mb-3">
                <label>Address</label>
                <textarea id="address" class="form-control" rows="2" placeholder="Organization Address"
                  required></textarea>
              </div>
              <div class="mb-3">
                <label>Organization Type</label>
                <select id="orgType" class="form-select" required>
                  <option value="">Select...</option>
                  <option value="NGO">NGO</option>
                  <option value="Business">Business</option>
                  <option value="Government">Government</option>
                  <option value="Individual">Individual</option>
                </select>
              </div>
              <div class="mb-3">
                <label>Country/Region</label>
                <select id="country" class="form-select" required>
                  <option value="">Select Country</option>
                  <option>Sri Lanka</option>
                  <option>India</option>
                  <option>Other</option>
                </select>
              </div>

              <div class="mb-3">
                <label>User Type</label>
                <select id="userType" class="form-select" required>
                  <option value="">Select User Type</option>
                  <option value="Donor">Donor</option>
                  <option value="Planter">Planter</option>
                </select>
              </div>

              <div class="mb-3">
                <label>Wallet Address (Cardano)</label>
                <input type="text" id="wallet" class="form-control" placeholder="addr1q...." required>
                <div class="form-text">Enter your Cardano wallet address for NFT transfers.</div>
              </div>


              <div class="mb-3">
                <label>Password</label>
                <input type="password" id="password" class="form-control" placeholder="Create password" required>
              </div>
              <div class="mb-3">
                <label>Confirm Password</label>
                <input type="password" id="confirmPassword" class="form-control" placeholder="Confirm password"
                  required>
              </div>
              <div class="form-check mb-3">
                <input class="form-check-input" type="checkbox" id="termsCheck" required>
                <label class="form-check-label" for="termsCheck">
                  I agree to the <a href="#">Terms</a> and <a href="#">Privacy Policy</a>
                </label>
              </div>
              <div class="g-recaptcha mb-3" data-sitekey="6LcGTncrAAAAAKwIxZA54ExtXxadPqfQTwAmE0v-"></div>
              <button type="submit" class="btn btn-success w-100" onclick="signupUser(event)">Create Account</button>
              <div class="mt-3 text-center">
                <small>Already have an account? <a href="login.html">Login</a></small>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    async function signupUser(event) {
      event.preventDefault();

      // Verify reCAPTCHA response
      const recaptchaResponse = grecaptcha.getResponse();
      if (!recaptchaResponse) {
        alert('❌ Please verify that you are not a robot.');
        return;
      }
      const formData = {
        orgName: document.getElementById('orgName').value,
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        name: document.getElementById('firstName').value + " " + document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        address: document.getElementById('address').value,
        orgType: document.getElementById('orgType').value,
        country: document.getElementById('country').value,
        userType: document.getElementById('userType').value,
        wallet: document.getElementById('wallet').value,
        password: document.getElementById('password').value,
        confirmPassword: document.getElementById('confirmPassword').value,
        recaptcha: recaptchaResponse
      };

      const res = await fetch('http://localhost:5000/api/signup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      });

      const data = await res.json();

      if (res.ok) {
        alert("✅ Signup successful!");
        window.location.href = 'login.html'; // Redirect to login if needed
      } else {
        alert("❌ " + data.error);
      }
    }
  </script>

</body>

</html>